---
layout: page
---

---

### IV-3. Genotyping SVs using SVTyper

In this part, we will briefly learn how to use SVTyper to genotype candidate SVs detected by LUMPY. 

---

#### Running SVTyper

SVTyper performs breakpoint genotyping of structural variants (SVs) using whole genome sequencing data. 
Users must supply a VCF file of sites to genotype (which may be generated by LUMPY) as well as a BAM/CRAM 
file of Illumina paired-end reads aligned with BWA-MEM. SVTyper assesses discordant and concordant reads 
from paired-end and split-read alignments to infer genotypes at each site.

SVTyper requires Python 2.7.x, pysam, numpy, and scipy. Our server has Anaconda installed with all required 
packages and SVTyper is also installed under /BiO/apps/bin/. 

* You need to add Anaconda path to your PATH variable:
> <pre>
# Edit your ~/.bashrc to add this line
export PATH=/BiO/apps/bin/anaconda2/bin:$PATH
# Source new bash resources
source ~/.bashrc </pre>

* Run SVTyper

> <pre>
svtyper \
 -i multi.sv.vcf \
 -B bams/NWD230091.bam,bams/NWD231092.bam,bams/NWD259170.bam,bams/NWD315403.bam,bams/NWD495157.bam,bams/NWD684137.bam \
 -l multi.genotype.json \
 -o multi.genotype.vcf </pre>


> <pre>
# Checkout multi.genotype.vcf file
less -S multi.genotype.vcf </pre>

* What do you recognize in the genotype fields of the genotype VCF file?

Now, let's make a visual identification of one of the SVs we genotyped. 
One way to do so is using samtools tview

> <pre>
samtools tview bams/NWD231092.bam </pre>

But it's not very good way to visualize large SVs.
You can use [IGV (Integrative Genome Viewer)](https://software.broadinstitute.org/software/igv/) for a better view.

* Download IGV onto your laptop.
* Launch IGV
* Depending on your setup, you might need JAVA update. 

Now, download BAM file using scp (Mac/Linux/Cygwin command-line). 

> <pre>
scp (your account)@:SERVER.IP.ADD.RESS~/sv/bams/NWD231092.bam* .  </pre>

If you do not have command-line scp on your Windows laptop, you can use [WinSCP](https://winscp.net).

* Select the correct reference genome version (Human hg38) from the dropdown list
* From the menu bar, select 'File' and 'Load from File'
* Go to one of the genotyped deletion locations  (chr22:36,740,000-36,760,000) 

---

Feel free to ask questions to your instructor(s) if you are stuck. 
Otherwise, let's go to next step 
, or go back to [Day 1 Overview](../day1).

---
